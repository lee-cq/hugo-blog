<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="åœ¨Kubernetesä¸­ï¼Œpodsæ˜¯èƒ½å¤Ÿåˆ›å»ºã€è°ƒåº¦ã€å’Œç®¡ç†çš„æœ€å°éƒ¨ç½²å•å…ƒï¼Œæ˜¯ä¸€ç»„å®¹å™¨çš„é›†åˆï¼Œè€Œä¸æ˜¯å•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚åŒä¸€ä¸ªPodé‡Œçš„å®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒIPåœ°å€åŠç«¯å£ç©ºé—´ã€‚"><title>Kubernetesçš„æ ¸å¿ƒ - Pod</title><link rel=canonical href=https://blog-g.leecq.cn/p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Kubernetesçš„æ ¸å¿ƒ - Pod"><meta property='og:description' content="åœ¨Kubernetesä¸­ï¼Œpodsæ˜¯èƒ½å¤Ÿåˆ›å»ºã€è°ƒåº¦ã€å’Œç®¡ç†çš„æœ€å°éƒ¨ç½²å•å…ƒï¼Œæ˜¯ä¸€ç»„å®¹å™¨çš„é›†åˆï¼Œè€Œä¸æ˜¯å•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚åŒä¸€ä¸ªPodé‡Œçš„å®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒIPåœ°å€åŠç«¯å£ç©ºé—´ã€‚"><meta property='og:url' content='https://blog-g.leecq.cn/p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/'><meta property='og:site_name' content='LeeCQå°ç©ºé—´'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='K8s'><meta property='article:tag' content='Kubernetes'><meta property='article:tag' content='è¿ç»´'><meta property='article:tag' content='Pod'><meta property='article:tag' content='ç”Ÿå‘½å‘¨æœŸ'><meta property='article:published_time' content='2024-08-05T00:00:00+00:00'><meta property='article:modified_time' content='2024-08-05T00:00:00+00:00'><meta name=twitter:title content="Kubernetesçš„æ ¸å¿ƒ - Pod"><meta name=twitter:description content="åœ¨Kubernetesä¸­ï¼Œpodsæ˜¯èƒ½å¤Ÿåˆ›å»ºã€è°ƒåº¦ã€å’Œç®¡ç†çš„æœ€å°éƒ¨ç½²å•å…ƒï¼Œæ˜¯ä¸€ç»„å®¹å™¨çš„é›†åˆï¼Œè€Œä¸æ˜¯å•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚åŒä¸€ä¸ªPodé‡Œçš„å®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒIPåœ°å€åŠç«¯å£ç©ºé—´ã€‚"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_f509edb42ecc0ebd.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LeeCQå°ç©ºé—´</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=menu-social><li><a href=https://github.com/Lee-CQ/hugo-blog target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://leecq.cn target=_blank title=Home rel=me><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/tools/><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7 2a1 1 0 00-.707 1.707L7 4.414v3.758a1 1 0 01-.293.707l-4 4C.817 14.769 2.156 18 4.828 18h10.343c2.673.0 4.012-3.231 2.122-5.121l-4-4A1 1 0 0113 8.172V4.414l.707-.707A1 1 0 0013 2H7zm2 6.172V4h2v4.172a3 3 0 00.879 2.12l1.027 1.028a4 4 0 00-2.171.102l-.47.156a4 4 0 01-2.53.0l-.563-.187a1.993 1.993.0 00-.114-.035l1.063-1.063A3 3 0 009 8.172z" clip-rule="evenodd"/></svg>
<span>Tools</span></a></li><li><a href=https://leecq.cn/ target=_blank><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>home</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#podçš„ç”Ÿå‘½å‘¨æœŸ>Podçš„ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href=#å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œé‡å¯ç­–ç•¥>å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œé‡å¯ç­–ç•¥</a></li><li><a href=#å®¹å™¨>å®¹å™¨</a></li><li><a href=#å¯åŠ¨å‘½ä»¤>å¯åŠ¨å‘½ä»¤</a></li><li><a href=#é•œåƒ>é•œåƒ</a></li><li><a href=#å¤–éƒ¨è¾“å…¥>å¤–éƒ¨è¾“å…¥</a></li><li><a href=#æ¢é’ˆprobe>æ¢é’ˆ(Probe)</a></li><li><a href=#èµ„æºé™åˆ¶---limit>èµ„æºé™åˆ¶ - limit</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/>Kubernetesçš„æ ¸å¿ƒ - Pod</a></h2><h3 class=article-subtitle>åœ¨Kubernetesä¸­ï¼Œpodsæ˜¯èƒ½å¤Ÿåˆ›å»ºã€è°ƒåº¦ã€å’Œç®¡ç†çš„æœ€å°éƒ¨ç½²å•å…ƒï¼Œæ˜¯ä¸€ç»„å®¹å™¨çš„é›†åˆï¼Œè€Œä¸æ˜¯å•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚åŒä¸€ä¸ªPodé‡Œçš„å®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒIPåœ°å€åŠç«¯å£ç©ºé—´ã€‚</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 05, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h1 id=kubernetesçš„æ ¸å¿ƒ---pod>Kubernetesçš„æ ¸å¿ƒ - Pod</h1><p>åœ¨Kubernetesä¸­ï¼Œpodsæ˜¯èƒ½å¤Ÿåˆ›å»ºã€è°ƒåº¦ã€å’Œç®¡ç†çš„æœ€å°éƒ¨ç½²å•å…ƒï¼Œæ˜¯ä¸€ç»„å®¹å™¨çš„é›†åˆï¼Œè€Œä¸æ˜¯å•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚</p><p>åŒä¸€ä¸ªPodé‡Œçš„å®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒIPåœ°å€åŠç«¯å£ç©ºé—´ã€‚</p><p>ä»ç”Ÿå‘½å‘¨æœŸæ¥è¯´ï¼ŒPodæ˜¯çŸ­æš‚çš„è€Œä¸æ˜¯é•¿ä¹…çš„åº”ç”¨ã€‚Podsè¢«è°ƒåº¦åˆ°èŠ‚ç‚¹ï¼Œä¿æŒåœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šç›´åˆ°è¢«é”€æ¯ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®šä¹‰Podçš„åŸºæœ¬è¦ç´ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>redis-django</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>label</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>webapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>key-value-store</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>frontend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>iamge</span><span class=p>:</span><span class=w> </span><span class=l>django</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=podçš„ç”Ÿå‘½å‘¨æœŸ>Podçš„ç”Ÿå‘½å‘¨æœŸ</h2><p>Podçš„statuså­—æ®µæ˜¯ä¸€ä¸ªPodStatuså¯¹è±¡ï¼ŒPodStatusä¸­æœ‰ä¸€ä¸ªphaseå­—æ®µã€‚phaseæ˜¯Podåœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­çš„ç®€å•å®è§‚æ¦‚è¿°ã€‚</p><p>PodStatuså¯¹è±¡è¿˜åŒ…å«ä¸€ä¸ªPodConditionã€‚æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªtypeå­—æ®µå’Œä¸€ä¸ªstatuså­—æ®µã€‚
typeå­—æ®µæ˜¯å­—ç¬¦ä¸²ï¼Œå¯èƒ½çš„å€¼æœ‰</p><ul><li>PodScheduled</li><li>Ready</li><li>Initialized</li><li>Unschedulable</li><li>ContainersReadyã€‚</li></ul><p>statuså­—æ®µæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯èƒ½çš„å€¼æœ‰</p><ul><li>True</li><li>False</li><li>Unknown</li></ul><p><img src=/p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/Pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg width=1319 height=322 srcset="/p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/Pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F_hu_9e33cab73793678d.jpg 480w, /p/kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83-pod/Pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F_hu_6fe2da89318acc46.jpg 1024w" loading=lazy alt=Podç”Ÿå‘½å‘¨æœŸ.jpg class=gallery-image data-flex-grow=409 data-flex-basis=983px></p><h2 id=å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œé‡å¯ç­–ç•¥>å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œé‡å¯ç­–ç•¥</h2><p>ä¸€æ—¦è°ƒåº¦å™¨å°†Podåˆ†æ´¾ç»™æŸä¸ªèŠ‚ç‚¹ï¼Œkubeletå°±é€šè¿‡runtimeä¸ºPodåˆ›å»ºå®¹å™¨ã€‚è¦æ£€æŸ¥Podä¸­å®¹å™¨çš„çŠ¶æ€ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>kubectl describe pod &lt;pod åç§°></code>ã€‚</p><p>å®¹å™¨çš„çŠ¶æ€æœ‰ä¸‰ç§ï¼š</p><ul><li>Waiting ï¼ˆç­‰å¾…ï¼‰</li><li>Runningï¼ˆè¿è¡Œä¸­ï¼‰</li><li>Terminatedï¼ˆå·²ç»ˆæ­¢ï¼‰</li></ul><p>å¦‚æœå®¹å™¨ä¸­çš„è¿›ç¨‹èƒ½å¤Ÿåœ¨é‡åˆ°é—®é¢˜æˆ–ä¸å¥åº·çš„æƒ…å†µä¸‹è‡ªè¡Œå´©æºƒï¼Œkubeletå°†æ ¹æ®Podçš„<code>restartPolicy</code>è‡ªåŠ¨æ‰§è¡Œä¿®å¤æ“ä½œã€‚æ­¤å­—æ®µå¯èƒ½å–å€¼åŒ…æ‹¬<code>Always</code>ã€<code>OnFailure</code>å’Œ<code>Never</code>ï¼Œé»˜è®¤å€¼æ˜¯<code>Always</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>command-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>purpose</span><span class=p>:</span><span class=w> </span><span class=l>demonstrate-command</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>command-demo-container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>debian</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;printenv&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;HOSTNAME&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;KUBERNETES_PORT&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=å®¹å™¨>å®¹å™¨</h2><p><strong>Infra/PauseContainerï¼š</strong> åŸºç¡€å®¹å™¨, podä¸­æ‰€æœ‰å®¹å™¨çš„çˆ¶å®¹å™¨ï¼Œä¸ºå…¶ä»–å®¹å™¨æä¾›å…±äº«çš„å‘½åç©ºé—´å’Œç½‘ç»œç©ºé—´</p><ul><li>ç”¨æˆ·ä¸å¯è§ï¼Œæ— éœ€æ„ŸçŸ¥ã€‚</li></ul><p><strong>InitContainersï¼š</strong> åˆå§‹åŒ–å®¹å™¨ï¼Œä¸€èˆ¬ç”¨äºæœåŠ¡ç­‰å¾…å¤„ç†ä»¥åŠæ³¨å†ŒPodä¿¡æ¯ç­‰ã€‚</p><ul><li>å…ˆäºä¸šåŠ¡å®¹å™¨å¼€å§‹æ‰§è¡Œï¼›</li><li>é¡ºåºæ‰§è¡Œï¼Œæ‰§è¡ŒæˆåŠŸé€€å‡ºï¼ˆexit 0ï¼‰ï¼Œå…¨éƒ¨æ‰§è¡ŒæˆåŠŸåå¼€å§‹å¯åŠ¨ä¸šåŠ¡å®¹å™¨ã€‚</li></ul><p><strong>Containersï¼š</strong> ä¸šåŠ¡å®¹å™¨ã€‚</p><ul><li>å¹¶è¡Œå¯åŠ¨ï¼Œå¯åŠ¨æˆåŠŸåä¸€ç›´Runningã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>label</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>myapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>initContainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>init-container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;until nslookup myservice; do echo waiting for myservice; sleep 2; done;&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>init-mydb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>until nslookup mydb; do echo waiting for mydb; sleep 2; done;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;echo The App is Running ... &amp;&amp; sleep 3600&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=å¯åŠ¨å‘½ä»¤>å¯åŠ¨å‘½ä»¤</h2><p>åœ¨åˆ›å»ºPodæ—¶ï¼Œå¯ä»¥ä¸ºå…¶ä¸‹çš„å®¹å™¨è®¾ç½®å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°ã€‚</p><p>å¯åŠ¨å‘½ä»¤ï¼š</p><ul><li><code>command</code>: è®¾ç½®å‘½ä»¤ï¼Œæ›¿æ¢é•œåƒä¸­çš„entrypointå’ŒCMDã€‚</li><li><code>args</code>: è®¾ç½®å‘½ä»¤çš„å‚æ•°ï¼Œä½œä¸ºentrypointçš„å…¥å‚ã€‚</li></ul><p>æŸ¥çœ‹ç»“æœï¼š
é€šè¿‡Podçš„æ—¥å¿—è¿›è¡ŒæŸ¥çœ‹ï¼š<code>$ kubectl logs command-demo</code></p><h2 id=é•œåƒ>é•œåƒ</h2><p>Image: é•œåƒåç§°å¯ä»¥åŒ…å«æ‰€åœ¨ä»“åº“çš„ä¸»æœºååŠæŒ‡å®šç‰ˆæœ¬çš„æ ‡ç­¾ã€‚è‹¥ä¸æŒ‡å®šä»“åº“çš„ä¸»æœºåå’Œæ ‡ç­¾ï¼ŒKubernetesé»˜è®¤ä½¿ç”¨Dockerå…¬å…±ä»“åº“ï¼Œæ‹‰å–æœ€æ–°ç‰ˆæœ¬é•œåƒï¼ˆ:latestï¼‰ã€‚</p><p>imagePullSecret: è‹¥Podåˆ›å»ºéœ€ä»ç§æœ‰ä»“åº“è¯»å–é•œåƒï¼Œåˆ™å¯é€šè¿‡é…ç½®æ­¤å­—æ®µæä¾›ä»“åº“çš„è®¿é—®å‡­è¯ã€‚ä¸ºä¿è¯å‡­æ®æ–‡ä»¶çš„å®‰å…¨ï¼Œå¯äº‹å…ˆå°†å…¶åˆ›å»ºä¸ºSecretå†è¿›è¡Œå¼•ç”¨ã€‚</p><p>imagePullPolicy: é•œåƒæ‹‰å–ç­–ç•¥ã€‚</p><ul><li>IfNotPresentï¼šä¼˜å…ˆä½¿ç”¨æœ¬åœ°é•œåƒã€‚</li><li>Alwaysï¼šæ¯æ¬¡å®¹å™¨å¯åŠ¨æ—¶éƒ½ä»é•œåƒåº“æ‹‰å–é•œåƒã€‚</li><li>Neverï¼šä»…ä½¿ç”¨æœ¬åœ°é•œåƒã€‚</li></ul><h2 id=å¤–éƒ¨è¾“å…¥>å¤–éƒ¨è¾“å…¥</h2><p>Podå¯ä»¥æ¥æ”¶å¤–éƒ¨è¾“å…¥çš„æ–¹å¼ï¼š ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶å’Œå¯†é’¥ã€‚</p><p>env: ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ç®€å•ï¼Œä½†ä¸€ä½†æ›´æ”¹å®¹å™¨å¿…é¡»é‡å¯ã€‚
- key-valueç›´æ¥å®šä¹‰ã€‚
- valueFromé…ç½®æ–‡ä»¶(ConfigMap)æˆ–å¯†é’¥(Secret)ã€‚</p><p>volume: ä»¥å·å½¢å¼æŒ‚è½½åˆ°å®¹å™¨å†…ä½¿ç”¨ï¼Œæƒé™å¯æ§ã€‚
é…ç½®æ–‡ä»¶(ConfigMap)æˆ–å¯†é’¥(Secret).</p><p>Podé…ç½®æ–‡ä»¶çš„éƒ¨åˆ†ç¤ºä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>APP_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>USER_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>secretKey</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>username</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cfg</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cfg</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>configMap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>items</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>age</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>age</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=æ¢é’ˆprobe>æ¢é’ˆ(Probe)</h2><p>æ¢é’ˆï¼ˆProbeï¼‰æ˜¯ç”±kubeletå¯¹å®¹å™¨æ‰§è¡Œçš„å®šæœŸè¯Šæ–­ã€‚è¯Šæ–­æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li>ExecActionï¼šåœ¨å®¹å™¨å†…æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ã€‚å¦‚æœå‘½ä»¤é€€å‡ºæ—¶è¿”å›ç ä¸º0åˆ™è®¤ä¸ºè¯Šæ–­æˆåŠŸã€‚</li><li>TCPSocketActionï¼šå¯¹æŒ‡å®šç«¯å£ä¸Šçš„å®¹å™¨çš„IPåœ°å€è¿›è¡ŒTCPæ£€æŸ¥ã€‚å¦‚æœç«¯å£æ‰“å¼€ï¼Œåˆ™è¯Šæ–­æˆåŠŸã€‚</li><li>HTTPGetActionï¼šå¯¹æŒ‡å®šçš„ç«¯å£å’Œè·¯å¾„ä¸Šçš„å®¹å™¨çš„IPåœ°å€æ‰§è¡ŒHTTP Getè¯·æ±‚ã€‚å¦‚æœå“åº”çš„çŠ¶æ€ç å¤§äºç­‰äº200ä¸”å°äº400ï¼Œåˆ™è¯Šæ–­æˆåŠŸã€‚</li></ul><p>Kubeletå¯ä»¥äºPodæ‰§è¡Œçš„ä¸¤ç§æ¢é’ˆç±»å‹ä¸ºï¼š</p><ul><li>å­˜æ´»æ¢é’ˆï¼ˆlivenessProbeï¼‰ï¼šæŒ‡ç¤ºå®¹å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚å¦‚æœå­˜æ´»æ¢æµ‹å¤±è´¥ï¼Œåˆ™kubeletä¼šæ€æ­»å®¹å™¨ï¼Œå¹¶ä¸”å®¹å™¨å°†å—åˆ°å…¶é‡å¯ç­–ç•¥çš„å½±å“ã€‚</li><li>å°±ç»ªæ¢é’ˆï¼ˆreadinessProbeï¼‰ï¼šæŒ‡ç¤ºå®¹å™¨æ˜¯å¦å‡†å¤‡å¥½æœåŠ¡è¯·æ±‚ã€‚å¦‚æœå°±ç»ªæ¢æµ‹å¤±è´¥ï¼ŒEndpoint Controllerå°†ä»ä¸PodåŒ¹é…çš„æ‰€æœ‰Serviceçš„Endpointsä¸­åˆ é™¤è¯¥Podçš„IPåœ°å€ã€‚</li></ul><p>ç”¨æˆ·é€šè¿‡<code>spec.container.livenessProbe</code>ï¼ˆæˆ–<code>spec.container.readinessProbe</code>ï¼‰å­—æ®µè®¾ç½®æ¢é’ˆã€‚Probesæ¶‰åŠçš„å­—æ®µå¦‚ä¸‹ï¼š</p><ul><li>initialDelaySecondsï¼šå®¹å™¨å¯åŠ¨åè¦ç­‰å¾…å¤šå°‘ç§’åå­˜æ´»å’Œå°±ç»ªæ¢æµ‹å™¨æ‰è¢«åˆå§‹åŒ–ã€‚é»˜è®¤å€¼ä¸º10ã€‚</li><li>periodSecondsï¼šæ‰§è¡Œæ¢æµ‹çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚é»˜è®¤å€¼ä¸º1ã€‚</li><li>successThresholdï¼šæ¢æµ‹å™¨åœ¨å¤±è´¥åï¼Œè¢«è§†ä¸ºæˆåŠŸçš„æœ€å°è¿ç»­æˆåŠŸæ•°ã€‚é»˜è®¤å€¼ä¸º1ã€‚</li><li>failureThresholdï¼šå½“æ¢æµ‹å¤±è´¥æ—¶ï¼ŒKubernetesçš„é‡è¯•æ¬¡æ•°ã€‚å­˜æ´»æ¢æµ‹æƒ…å†µä¸‹çš„æ”¾å¼ƒå°±æ„å‘³ç€é‡æ–°å¯åŠ¨å®¹å™¨ã€‚å°±ç»ªæ¢æµ‹æƒ…å†µä¸‹çš„æ”¾å¼ƒPodä¼šè¢«æ‰“ä¸Šæœªå°±ç»ªçš„æ ‡ç­¾ã€‚é»˜è®¤å€¼ä¸º3ã€‚</li></ul><p>æ¢é’ˆçš„ç¤ºä¾‹é…ç½®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># å­˜æ´»æ¢é’ˆ - æ£€æŸ¥æ–‡ä»¶/tmp/healthy æ˜¯å¦å­˜åœ¨ (å®¹å™¨å¯åŠ¨5såå¼€å§‹ï¼Œæ¯æ¬¡é—´éš”5s)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>exec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;cat&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;/tmp/healthy&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>periodSecond</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># å°±ç»ªæ¢é’ˆ - æ£€æŸ¥ç«¯å£8080æ˜¯å¦å¼€æ”¾(å®¹å™¨å¯åŠ¨å5så¼€å§‹ï¼Œæ¯æ¬¡é—´éš”10s)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tcpSocket</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>periodSecond</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># å­˜æ´»æ¢é’ˆ - æ£€æŸ¥http://lo:8080/healthzçš„çŠ¶æ€ç æ˜¯å¦åœ¨200-399ä¹‹é—´</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/healthz</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>httpHeaders</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Custom-Header</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>Awesome</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=èµ„æºé™åˆ¶---limit>èµ„æºé™åˆ¶ - limit</h2><p>Kubernetesçš„èµ„æºé™åˆ¶æ˜¯é€šè¿‡æ¯ä¸ªå®¹å™¨containerSpecçš„resourceså­—æ®µè¿›è¡Œè®¾ç½®çš„ã€‚</p><p>CPUèµ„æºï¼š</p><ul><li>å•ä½ï¼šä»¥CPUä¸ºå•ä½ï¼Œä¹Ÿæ”¯æŒå¸¦å°æ•°å€¼çš„ä½¿ç”¨ï¼Œå¦‚ï¼šcpu: â€œ0.5â€æˆ–cpu:500mã€‚</li><li>CPUè¯·æ±‚ï¼ˆrequestï¼‰ï¼šåˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„CPUèµ„æºã€‚</li><li>CPUé™åˆ¶ï¼ˆlimitï¼‰ï¼šCPUçš„èµ„æºä¸Šé™ã€‚</li></ul><p>å†…å­˜èµ„æºï¼š</p><ul><li>å•ä½ï¼šä»¥å­—èŠ‚ï¼ˆbyteï¼‰ä¸ºå•ä½ï¼Œå¯è¡¨ç¤ºä¸ºçº¯æ•´æ•°æˆ–å®šç‚¹æ•´æ•°ï¼šEã€Pã€Tã€Gã€Mã€Kæˆ–Eiã€Piã€Tiã€Giã€Miã€Kiã€‚</li><li>å†…å­˜è¯·æ±‚ï¼ˆrequestï¼‰ï¼šåˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„å†…å­˜èµ„æºã€‚</li><li>å†…å­˜é™åˆ¶ï¼ˆlimitï¼‰ï¼šå†…å­˜çš„èµ„æºä¸Šé™ã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;100Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;250m&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;200Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;500m&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/k8s/>K8s</a>
<a href=/tags/kubernetes/>Kubernetes</a>
<a href=/tags/%E8%BF%90%E7%BB%B4/>è¿ç»´</a>
<a href=/tags/pod/>Pod</a>
<a href=/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/>ç”Ÿå‘½å‘¨æœŸ</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/kubernetes%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%8D%95%E5%85%83-%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD/><div class=article-details><h2 class=article-title>Kubernetesçš„æœåŠ¡å•å…ƒ - å·¥ä½œè´Ÿè½½</h2></div></a></article><article><a href=/p/kubernetes%E7%9A%84%E5%AD%98%E5%82%A8/><div class=article-details><h2 class=article-title>Kubernetesçš„å­˜å‚¨</h2></div></a></article><article><a href=/p/kubernetes%E7%9A%84%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE-ingress/><div class=article-details><h2 class=article-title>Kubernetesçš„æœåŠ¡è®¿é—®-Ingress</h2></div></a></article><article><a href=/p/kubernetes%E7%9A%84%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE-service/><div class=article-details><h2 class=article-title>Kubernetesçš„æœåŠ¡è®¿é—®-Service</h2></div></a></article><article><a href=/p/kubernetes%E7%9A%84%E9%85%8D%E7%BD%AE%E6%9E%B6%E6%9E%84/><div class=article-details><h2 class=article-title>Kubernetesçš„é…ç½®æ¶æ„</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=lee-cq/hugo-blog data-repo-id=R_kgDOHhaNdw data-category=Announcements data-category-id=DIC_kwDOHhaNd84CQtzr data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 LeeCQå°ç©ºé—´</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>